<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <title></title>
    <script src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js" type="text/javascript"></script>

    <link href="css/bootstrap.v3.2.e2d3.min.css" rel="stylesheet" type="text/css" />
    <link href="css/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <link href="css/style.css" rel="stylesheet" type="text/css" />

</head>
<body>
<div id="e2d3-navi-header-area">
    <div id="e2d3-sample-header"></div>
</div>
<div id="e2d3-chart-area" class="container-fluid"></div>
<div id="e2d3-footer"><hr />Powered by E2D3.</div>
<script src="js/core/e2d3.js" type="text/javascript"></script>
<script src="js/jquery/jquery.v2.min.js" type="text/javascript"></script>
<script src="js/jquery/jquery.e2d3.js" type="text/javascript"></script>
<script src="js/bs/bootstrap.v3.2.min.js" type="text/javascript"></script>

<script src="js/lib/d3.min.js"></script>
<script src="js/lib/topojson.v1.6.js" type="text/javascript"></script>
<script type="text/javascript">
    /**
 * Global
 */
    var e2d3BindId = 'e2d3BindId';
    var e2d3BindData;
    /**
     * on load
     */
    init();
    $(document).ready(function(){
        e2d3.initialize(function(){
            /**
             * check bind
             */
            try{
                

            }catch (e){
                console.log(e);
            }
        });


    });
    function init() {
        $.getJSON("sample.json", function (json) {
            if (json) {
                console.log();
                var box = $("<div>").addClass("row");
                $('#e2d3-chart-area').append(box);
                $(json).each(function () {

                    var li = $("<div>").addClass("col-xs-4 col-md-3");
                    var liP = $("<div>").addClass("panel panel-default");
                    var liH = $("<div>").addClass("panel-heading").append($("<h3>").addClass("panel-title").html(this.name));
                    var liB = $("<div>").addClass("panel-body").html(this.description);
                    $(liB).append("<hr>");
                    $(liB).append($("<div>").addClass("text-center").append($("<button>").addClass("btn btn-warning e2d3-set-sample-data").attr("data-e2d3-path",this.path).html("Set Data")));
                    $(liP).append([liH,liB]);$(li).append(liP); $(box).append(li);
                });
            }
        });
        $(document).on("click",".e2d3-set-sample-data",function(){
            d3.text(d3.select(this).attr("data-e2d3-path"), function(text) {
                var data = d3.csv.parseRows(text);
                e2d3.json2Excel(data,
                        function () {
                            e2d3.setBindData(
                                    { id: e2d3BindId },
                                    function (binding) {
                                        console.log(binding);
                                        if (binding) {
                                            //e2d3.addChangeEvent(binding, e2d3Update());
                                            location.href = 'chart.html';
                                        } else {
                                            console.log(binding);
                                        }
                                    });
                        });
            });
        });
    }

</script>

</body>
</html>
